<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IFSP Eventos - Guarulhos</title>
    <!-- Estilos -->
    <link rel="stylesheet" href="style.css">
    <!-- √çcones Google -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
</head>
<body>

<div id="app-container">
    
    <!-- HEADER -->
    <header id="main-header" class="hidden">
        <div style="display: flex; align-items: center;">
            <button class="back-btn hidden" id="btn-back" onclick="goBack()">
                <span class="material-symbols-outlined">arrow_back</span>
            </button>
            <div>
                <div class="logo-text">IFSP Eventos</div>
                <span class="campus-text">C√¢mpus Guarulhos</span>
            </div>
        </div>
        <div class="header-actions">
            <button onclick="toggleNotifications()" class="icon-btn" style="position: relative;">
                <span class="material-symbols-outlined">notifications</span>
                <span id="notif-badge" class="badge hidden">0</span>
            </button>
            <span id="user-name-display" class="user-display-name">Visitante</span>
            <button onclick="doLogout()" title="Sair" class="icon-btn">
                <span class="material-symbols-outlined">logout</span>
            </button>
        </div>
    </header>

    <!-- ================= MODAIS ================= -->

    <!-- Modal Notifica√ß√µes -->
    <div id="modal-notifications" class="modal-overlay hidden" onclick="if(event.target === this) toggleNotifications()">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <h3>Notifica√ß√µes</h3>
                <span class="material-symbols-outlined" onclick="toggleNotifications()" style="cursor:pointer; color:#666;">close</span>
            </div>
            <div id="notifications-list"></div>
        </div>
    </div>

    <!-- Modal Sele√ß√£o de Time -->
    <div id="modal-team-select" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Escolha um Time</h3>
            <p class="text-small">Qual time deseja inscrever nesta competi√ß√£o?</p>
            <div id="team-select-list" style="display: flex; flex-direction: column; gap: 8px; margin: 15px 0;"></div>
            <button class="btn btn-secondary" onclick="closeTeamSelect()">Cancelar</button>
        </div>
    </div>

    <!-- Modal Gerar Chaves (HU 09) -->
    <div id="modal-generate-brackets" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Gerar Chaves</h3>
            <p class="text-small" style="margin-bottom: 15px;">Aten√ß√£o: Isso ir√° substituir a tabela de jogos atual.</p>
            <div class="form-group">
                <label>Formato da Competi√ß√£o</label>
                <select id="bracket-format">
                    <option value="MATA_MATA">Mata-mata (Eliminat√≥rias)</option>
                    <option value="PONTOS_CORRIDOS">Pontos Corridos (Liga)</option>
                    <option value="GRUPOS">Fases de Grupo + Final</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="confirmGenerateBrackets()">Gerar Tabela</button>
            <button class="btn btn-secondary" onclick="document.getElementById('modal-generate-brackets').classList.add('hidden')" style="margin-top: 10px;">Cancelar</button>
        </div>
    </div>

    <!-- ================= TELAS ================= -->

    <!-- TELA 1: LOGIN -->
    <div id="screen-login" class="view active" style="justify-content: center; background: linear-gradient(135deg, var(--ifsp-green) 0%, var(--ifsp-green-dark) 100%); color: white;">
        <div class="text-center" style="margin-bottom: 40px;">
            <h1 style="font-size: 2.5rem; margin-bottom: 10px;">IFSP</h1>
            <p>Sistema de Competi√ß√µes</p>
        </div>
        <div style="background: white; padding: 24px; border-radius: 16px; color: #333; box-shadow: 0 10px 25px rgba(0,0,0,0.2);">
            <div class="form-group">
                <label>E-mail Institucional</label>
                <input type="email" id="login-email" placeholder="seu.email@ifsp.edu.br" value="aluno@aluno.ifsp.edu.br">
            </div>
            <div class="form-group">
                <label>Senha</label>
                <input type="password" id="login-password" value="123456">
            </div>
            <button class="btn btn-primary" onclick="doLogin()">ENTRAR</button>
            <div class="text-center" style="margin-top: 15px;">
                <a href="#" onclick="forgotPassword()" style="color: var(--ifsp-green); font-size: 0.9rem; text-decoration: none;">Esqueci minha senha</a>
            </div>
            <div class="text-center" style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 15px;">
                <span class="text-small">N√£o tem conta? </span>
                <a href="#" onclick="navigateTo('screen-register')" style="color: var(--ifsp-green); font-weight: bold; text-decoration: none;">Cadastre-se</a>
            </div>
        </div>
        <div class="text-center" style="margin-top: 30px; font-size: 0.75rem; opacity: 0.7;">
            <p>Acesso R√°pido para Teste:</p>
            <p>Admin: <strong>admin@ifsp</strong> | Gestor: <strong>gestor@ifsp</strong></p>
        </div>
    </div>

    <!-- TELA: REGISTRO (HU 05) -->
    <div id="screen-register" class="view" style="justify-content: center;">
        <div class="card" style="border:none; box-shadow:none; background:transparent;">
            <h2 style="margin-bottom: 20px; color: var(--ifsp-green-dark); text-align: center;">Nova Conta</h2>
            <form onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label>Nome Completo</label>
                    <input type="text" id="reg-name" required placeholder="Seu nome">
                </div>
                <div class="form-group">
                    <label>E-mail Institucional</label>
                    <input type="email" id="reg-email" required placeholder="@ifsp.edu.br">
                </div>
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" id="reg-pass" required placeholder="M√≠nimo 6 caracteres">
                </div>
                <button type="submit" class="btn btn-primary">Criar Conta</button>
                <button type="button" class="btn btn-secondary" onclick="navigateTo('screen-login')">Voltar ao Login</button>
            </form>
        </div>
    </div>

    <!-- TELA 2: FEED (HOME) -->
    <div id="screen-feed" class="view">
        <h2 style="margin-bottom: 16px;">Eventos</h2>
        
        <!-- Filtros de Modalidade -->
        <div class="filters-scroll">
            <span class="tag aberto" onclick="filterEvents('all')" style="cursor:pointer;">Todos</span>
            <span class="tag" onclick="filterEvents('Futsal')" style="background:#eee; color:#555; cursor:pointer;">Futsal</span>
            <span class="tag" onclick="filterEvents('Volei')" style="background:#eee; color:#555; cursor:pointer;">V√¥lei</span>
            <span class="tag" onclick="filterEvents('Xadrez')" style="background:#eee; color:#555; cursor:pointer;">Xadrez</span>
            <span class="tag" onclick="filterEvents('Handebol')" style="background:#eee; color:#555; cursor:pointer;">Handebol</span>
        </div>

        <div id="events-list" style="margin-top: 10px;">
            <!-- Lista de Cards inserida via JS -->
        </div>

        <!-- Bot√£o Flutuante (Fab) - Apenas Gestor/Admin -->
        <div id="fab-create" class="btn-float hidden" onclick="prepareCreateEvent()" title="Novo Evento">
            <span class="material-symbols-outlined">add</span>
        </div>
    </div>

    <!-- TELA: ADMIN USU√ÅRIOS (HU 14) -->
    <div id="screen-admin-users" class="view">
        <h2 style="margin-bottom: 16px;">Gest√£o de Usu√°rios</h2>
        <p class="text-small" style="margin-bottom: 10px;">Controle de acesso e permiss√µes.</p>
        <div id="admin-users-list">
            <!-- Lista de Usu√°rios via JS -->
        </div>
    </div>

    <!-- TELA: COMUNIDADES -->
    <div id="screen-communities" class="view">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h2>Comunidades</h2>
            <button class="btn-small" onclick="navigateTo('screen-create-community')">
                <span class="material-symbols-outlined" style="font-size: 1rem; vertical-align: -2px;">add</span> Criar
            </button>
        </div>
        <div id="communities-list"></div>
    </div>

    <!-- TELA: DETALHES DA COMUNIDADE (FEED SOCIAL) -->
    <div id="screen-community-details" class="view">
        <div id="comm-header" style="border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 15px;"></div>
        
        <!-- √Årea de Postagem -->
        <div class="post-creator-area">
            <div style="display:flex; gap:10px; align-items:center; margin-bottom:10px;">
                <div class="avatar-small" id="user-avatar-post">U</div>
                <input type="text" id="post-input" placeholder="Compartilhe algo com o grupo..." style="flex:1; border:none; background:transparent; outline:none;">
            </div>
            <div style="display:flex; justify-content:flex-end;">
                <button class="btn-small" onclick="handlePost()">Publicar</button>
            </div>
        </div>

        <h4 style="margin-bottom: 10px; color:#555;">Discuss√µes Recentes</h4>
        <div id="community-feed-list"></div>
    </div>

    <!-- TELA: CRIAR COMUNIDADE -->
    <div id="screen-create-community" class="view">
        <h2 style="margin-bottom: 20px;">Nova Comunidade</h2>
        <form onsubmit="handleCreateCommunity(event)">
            <div class="form-group">
                <label>Nome da Comunidade</label>
                <input type="text" id="comm-name" required placeholder="Ex: Torcida Organizada">
            </div>
            <div class="form-group">
                <label>Descri√ß√£o</label>
                <textarea id="comm-desc" rows="3" required placeholder="Objetivo do grupo..."></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Criar Comunidade</button>
        </form>
    </div>

    <!-- TELA: MEUS TIMES E INSCRI√á√ïES -->
    <div id="screen-my-events" class="view">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <h3>Meus Times</h3>
            <button class="btn-small" onclick="navigateTo('screen-create-team')">
                <span class="material-symbols-outlined" style="font-size: 1rem; vertical-align: -2px;">add</span> Novo Time
            </button>
        </div>
        
        <!-- Slider Horizontal de Times -->
        <div id="my-teams-slider" class="horizontal-scroll-container"></div>

        <div class="divider"></div>

        <h3 style="margin-bottom: 16px; margin-top: 10px;">Minhas Inscri√ß√µes Ativas</h3>
        <div id="my-events-list"></div>
        
        <div id="empty-my-events" class="text-center hidden" style="margin-top: 40px; color: #999;">
            <span class="material-symbols-outlined" style="font-size: 3rem; opacity: 0.5;">event_busy</span>
            <p style="margin-top: 10px;">Voc√™ n√£o est√° inscrito em eventos.</p>
            <button class="btn btn-secondary" style="width: auto; margin-top: 15px;" onclick="navigateTo('screen-feed')">Ver Eventos Abertos</button>
        </div>
    </div>

    <!-- TELA: RANKING -->
    <div id="screen-ranking" class="view">
        <h2 style="margin-bottom: 16px;">Ranking Geral üèÜ</h2>
        <p class="text-small" style="margin-bottom: 15px;">Pontua√ß√£o baseada em participa√ß√£o e vit√≥rias.</p>
        <div class="ranking-table" id="ranking-list"></div>
    </div>

    <!-- TELA: PERFIL -->
    <div id="screen-profile" class="view">
        <h2 style="margin-bottom: 16px;">Meu Perfil</h2>
        <div class="profile-header">
            <div class="avatar" id="profile-avatar">A</div>
            <h3 id="profile-name">Usu√°rio</h3>
            <span id="profile-email" style="color: #777; font-size: 0.9rem;">email@ifsp.edu.br</span>
            
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="profile-points">0</div>
                    <div class="stat-label">Pontos</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="profile-level">BRONZE</div>
                    <div class="stat-label">N√≠vel</div>
                </div>
                <div class="stat-item" onclick="navigateTo('screen-ranking')" style="cursor: pointer;">
                    <div class="stat-value" id="profile-rank">-</div>
                    <div class="stat-label" style="text-decoration: underline; color: var(--ifsp-green);">Rank</div>
                </div>
            </div>
        </div>

        <h4 style="margin-bottom: 10px;">Esportes de Interesse (HU 07)</h4>
        <div class="interest-chips" id="interests-list"></div>

        <div style="margin-top: 30px;">
            <div class="divider"></div>
            <div class="text-center" style="margin-top: 20px;">
                <button class="btn-danger-small" style="width: 100%; background-color: transparent; color: var(--ifsp-red); border: 1px solid var(--ifsp-red);" onclick="doLogout()">
                    Sair da Conta
                </button>
            </div>
        </div>
    </div>

    <!-- TELA: CADASTRO/EDI√á√ÉO DE EVENTO (HU 01, 02, 04) -->
    <div id="screen-create-event" class="view">
        <h2 style="margin-bottom: 20px;" id="form-event-title">Novo Evento</h2>
        <form id="form-create-event" onsubmit="handleSaveEvent(event)">
            <input type="hidden" id="evt-id">
            <div class="form-group">
                <label>Nome do Evento</label>
                <input type="text" id="evt-nome" required placeholder="Ex: Interclasse 2024">
            </div>
            <div class="form-group">
                <label>Descri√ß√£o</label>
                <textarea id="evt-desc" rows="3" required placeholder="Detalhes da competi√ß√£o..."></textarea>
            </div>
            <div style="display: flex; gap: 10px;">
                <div class="form-group" style="flex: 1;">
                    <label>In√≠cio</label>
                    <input type="date" id="evt-inicio" required>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>Fim</label>
                    <input type="date" id="evt-fim" required>
                </div>
            </div>
            
            <div class="form-group">
                <label>Modalidades (M√∫ltipla Escolha - HU 04)</label>
                <div class="checkbox-group" style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 5px;">
                    <label class="check-label"><input type="checkbox" name="modalidades" value="Futsal"> Futsal</label>
                    <label class="check-label"><input type="checkbox" name="modalidades" value="Volei"> V√¥lei</label>
                    <label class="check-label"><input type="checkbox" name="modalidades" value="Xadrez"> Xadrez</label>
                    <label class="check-label"><input type="checkbox" name="modalidades" value="Handebol"> Handebol</label>
                    <label class="check-label"><input type="checkbox" name="modalidades" value="Basquete"> Basquete</label>
                </div>
            </div>

            <div class="form-group">
                <label>Status Inicial</label>
                <select id="evt-status">
                    <option value="INSCRICOES_ABERTAS">Inscri√ß√µes Abertas</option>
                    <option value="AGUARDANDO_INICIO">Aguardando In√≠cio</option>
                    <option value="EM_ANDAMENTO">Em Andamento</option>
                    <option value="ENCERRADO">Encerrado</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Salvar Evento</button>
        </form>
    </div>

    <!-- TELA: CRIAR TIME -->
    <div id="screen-create-team" class="view">
        <h2 style="margin-bottom: 20px;">Novo Time</h2>
        <form onsubmit="handleCreateTeam(event)">
            <div class="form-group">
                <label>Nome do Time</label>
                <input type="text" id="team-name" required placeholder="Ex: Os Imbat√≠veis">
            </div>
            <div class="form-group">
                <label>Modalidade Principal</label>
                <select id="team-modality">
                    <option value="Futsal">Futsal</option>
                    <option value="Volei">V√¥lei</option>
                    <option value="Xadrez">Xadrez</option>
                    <option value="Handebol">Handebol</option>
                    <option value="Basquete">Basquete</option>
                </select>
            </div>
            <p class="text-small" style="color:#666; margin-bottom: 15px;">Voc√™ ser√° cadastrado automaticamente como capit√£o.</p>
            <button type="submit" class="btn btn-primary">Criar Time</button>
        </form>
    </div>

    <!-- TELA 4: DETALHES DO EVENTO -->
    <div id="screen-event-details" class="view">
        <div id="event-info-container" style="margin-bottom: 15px;"></div>
        
        <!-- √ÅREA DO GESTOR: A√á√ïES -->
        <div id="manager-actions-area" class="hidden" style="margin-bottom: 20px; display: flex; gap: 10px;">
            <!-- Inserido via JS -->
        </div>

        <!-- √ÅREA DO GESTOR: APROVA√á√ÉO (HU 12) -->
        <div id="admin-approval-area" class="hidden" style="background-color: #fff3e0; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #ffe0b2;">
            <h4 style="color: #e65100; margin-bottom: 10px; display: flex; align-items: center;">
                <span class="material-symbols-outlined" style="font-size: 1.2rem; margin-right: 5px;">pending_actions</span>
                Solicita√ß√µes Pendentes
            </h4>
            <div id="pending-teams-list"></div>
        </div>

        <div style="background: #eee; padding: 10px; border-radius: 8px; margin-bottom: 15px; text-align: center;">
            <strong style="color: #555;">Jogos da Competi√ß√£o</strong>
        </div>
        <div id="matches-list"></div>
    </div>

    <!-- TELA 5: S√öMULA DA PARTIDA (HU 11 e 12) -->
    <div id="screen-match-details" class="view">
        <div class="card text-center" style="margin-bottom: 20px;">
            <span class="tag andamento" style="margin-bottom: 10px;">EM ANDAMENTO</span>
            <h2 style="color: var(--ifsp-green);" id="match-title-display">Detalhes da Partida</h2>
            
            <div class="match-score" style="margin: 20px 0;">
                <div style="flex: 1;">
                    <strong style="display: block; font-size: 1.1rem;" id="team-a-display">Time A</strong>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <input type="number" id="score-a" class="team-score" value="0">
                    <span>X</span>
                    <input type="number" id="score-b" class="team-score" value="0">
                </div>
                <div style="flex: 1;">
                    <strong style="display: block; font-size: 1.1rem;" id="team-b-display">Time B</strong>
                </div>
            </div>

            <div class="form-group" style="text-align: left;">
                <label>S√∫mula / Ocorr√™ncias</label>
                <textarea rows="3" placeholder="Gols, cart√µes, observa√ß√µes..."></textarea>
            </div>

            <div style="display: flex; gap: 10px;">
                <button class="btn btn-secondary" style="flex:1;" onclick="saveMatchResult()">Sugerir Resultado</button>
                <button id="btn-approve-result" class="btn btn-primary" style="flex:1;" onclick="approveResult()">Aprovar (Gestor)</button>
            </div>
        </div>

        <!-- VOTA√á√ÉO (Craque da Galera) -->
        <h3 style="margin-bottom: 10px;">Craque da Galera ‚öΩ</h3>
        <p class="text-small" style="margin-bottom: 10px;">Vote no melhor jogador em campo!</p>
        <div id="voting-list"></div>
    </div>

    <!-- BARRA DE NAVEGA√á√ÉO -->
    <nav id="bottom-nav" class="bottom-nav hidden">
        <div class="nav-item active" id="nav-home" onclick="navigateTo('screen-feed')">
            <span class="nav-icon"><span class="material-symbols-outlined">home</span></span>
            <span>In√≠cio</span>
        </div>
        <div class="nav-item" id="nav-communities" onclick="navigateTo('screen-communities')">
            <span class="nav-icon"><span class="material-symbols-outlined">groups</span></span>
            <span>Comunidades</span>
        </div>
        <div class="nav-item" id="nav-events" onclick="navigateTo('screen-my-events')">
            <span class="nav-icon"><span class="material-symbols-outlined">trophy</span></span>
            <span>Times</span>
        </div>
        <div class="nav-item" id="nav-profile" onclick="navigateTo('screen-profile')">
            <span class="nav-icon"><span class="material-symbols-outlined">person</span></span>
            <span>Perfil</span>
        </div>
        <!-- HU 14: Item Admin -->
        <div class="nav-item hidden" id="nav-admin" onclick="navigateTo('screen-admin-users')">
            <span class="nav-icon"><span class="material-symbols-outlined">admin_panel_settings</span></span>
            <span>Admin</span>
        </div>
    </nav>

</div>

<!-- Script Principal -->
<script src="script.js"></script>
</body>
</html>